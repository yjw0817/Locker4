# 🧪 락커 회전 및 인접 배치 테스트 가이드

## 📋 테스트 환경
- **URL**: http://localhost:3000/
- **페이지**: 락커 배치 (LockerPlacementFigma)
- **브라우저**: Chrome/Safari 권장

## ✅ 버그 수정 확인 사항

### 1. 회전 지속성 테스트 (Bug #1 Fix)

#### 테스트 단계:
1. 락커를 하나 배치합니다
2. 락커를 선택합니다 (클릭)
3. **R키를 여러 번 누릅니다** (10번 이상)

#### 예상 결과:
```
콘솔 로그:
[Rotation] Locker locker-xxx: 0° -> 45° (normalized: 45°)
[Rotation] Verified: 45°
[Rotation] Locker locker-xxx: 45° -> 90° (normalized: 90°)
[Rotation] Verified: 90°
[Rotation] Locker locker-xxx: 90° -> 135° (normalized: 135°)
[Rotation] Verified: 135°
... (계속 증가)
```

#### ❌ 수정 전 문제:
- 항상 "0° -> 45°"만 반복됨
- 회전 각도가 저장되지 않음

#### ✅ 수정 후:
- 회전 각도가 누적되어 증가
- 360도 이상도 정상 처리 (자동으로 0-359 범위로 정규화)

### 2. 인접 배치 테스트 (Bug #2 Fix)

#### 테스트 단계:
1. 첫 번째 락커를 (100, 100) 위치에 배치
2. 두 번째 락커를 첫 번째 락커 **바로 옆에** 배치 시도
3. 간격 없이 정확히 붙여서 배치

#### 예상 결과:
- **간격 0px로 정확히 붙어서 배치 가능**
- 겹치는 것만 방지됨
- 콘솔: `[Placement] Locker placed at (140, 100)` (40x40 락커 기준)

### 3. 자동 스냅 테스트

#### 테스트 단계:
1. 락커를 하나 배치
2. 새 락커를 기존 락커 **10px 이내**로 가까이 가져가기
3. 마우스를 놓으면 자동으로 붙음

#### 예상 결과:
```
콘솔 로그:
[Snap] Snapped to right of locker L1
[Snap] Final position: (140, 100)
[Placement] Locker placed at (140, 100) (snapped)
```

#### 시각적 피드백:
- 10px 이내 접근 시 미리보기가 자동으로 스냅 위치로 이동
- 녹색 미리보기: 배치 가능
- 빨간색 미리보기: 충돌 (겹침)

### 4. 드래그 중 스냅 테스트

#### 테스트 단계:
1. 기존 락커를 드래그로 이동
2. 다른 락커 근처(10px 이내)로 드래그
3. 자동으로 붙는지 확인

#### 예상 결과:
- 드래그 중에도 스냅 동작
- 충돌 시 원위치로 복귀

## 🔍 디버그 로그 확인

개발자 도구 콘솔(F12)에서 다음 로그 확인:

### 정상 로그 패턴:
```javascript
[Rotation] Locker xxx: 45° -> 90° (normalized: 90°)
[Rotation] Verified: 90°
[Snap] Snapped to right of locker L1
[Snap] Final position: (140, 100)
[Placement] Locker placed at (140, 100) (snapped)
[Collision] Detected between lockers {...}
```

### 에러 확인:
- `undefined` 값이 나타나면 문제
- rotation이 항상 0이면 버그 미해결

## 📐 테스트 시나리오

### 시나리오 1: 격자 배치
```
[L1][L2][L3]  <- 가로로 붙여서 배치
[L4][L5][L6]  <- 세로로도 붙여서 배치
```

### 시나리오 2: 회전 + 인접 배치
1. L1 배치 후 45도 회전
2. L2를 L1 옆에 스냅으로 배치
3. 회전된 락커도 정확히 붙는지 확인

### 시나리오 3: 복잡한 레이아웃
```
    [L1]
[L2][L3][L4]
    [L5]
```
중앙 락커 주변에 4개 배치

## 🎮 단축키 정리

| 키 | 동작 | 상태 |
|---|------|------|
| **R** | 선택된 락커 45도 회전 | ✅ 수정됨 |
| **Shift+R** | 반시계 방향 회전 | ✅ 동작 |
| **Delete** | 선택된 락커 삭제 | ✅ 동작 |
| **Ctrl+G** | 자동 정렬 | ✅ 동작 |
| **화살표** | 락커 이동 | ✅ 동작 |
| **Shift+화살표** | 빠른 이동 (20px) | ✅ 동작 |

## 💡 추가 개선 사항

### 구현된 기능:
- ✅ 회전 각도 지속성
- ✅ 인접 배치 (0px 간격)
- ✅ 10px 자동 스냅
- ✅ 충돌 방지 (겹침만)
- ✅ 디버그 로깅

### 향후 개선 가능:
- 다중 선택 및 그룹 이동
- 스냅 거리 조절 옵션
- 회전 중심점 표시
- 자석 효과 시각화

## 🐛 문제 발생 시

1. **회전이 안 되는 경우**:
   - 락커가 선택되어 있는지 확인
   - 콘솔에서 에러 확인

2. **스냅이 안 되는 경우**:
   - 10px 이내로 충분히 가까이 있는지 확인
   - 다른 락커와 겹치지 않는지 확인

3. **배치가 안 되는 경우**:
   - 구역이 선택되어 있는지 확인
   - 락커 타입이 선택되어 있는지 확인

---

## 📊 테스트 결과 기록

| 테스트 항목 | 상태 | 비고 |
|------------|------|------|
| R키 연속 회전 | ⏳ | 테스트 필요 |
| 인접 배치 (0px) | ⏳ | 테스트 필요 |
| 10px 자동 스냅 | ⏳ | 테스트 필요 |
| 드래그 중 스냅 | ⏳ | 테스트 필요 |
| 회전 후 충돌 체크 | ⏳ | 테스트 필요 |

테스트 완료 후 각 항목을 ✅로 변경해주세요.